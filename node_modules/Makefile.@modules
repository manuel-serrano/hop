#*=====================================================================*/
#*    serrano/prgm/project/hop/hop/node_modules/Makefile.@modules      */
#*    -------------------------------------------------------------    */
#*    Author      :  Manuel Serrano                                    */
#*    Creation    :  Fri Oct 20 07:47:22 2017                          */
#*    Last change :  Thu Jan 30 11:55:13 2025 (serrano)                */
#*    Copyright   :  2017-25 Manuel Serrano                            */
#*    -------------------------------------------------------------    */
#*    Common Makefile to build nodejs_modules                          */
#*=====================================================================*/

#*---------------------------------------------------------------------*/
#*    Configuration                                                    */
#*---------------------------------------------------------------------*/
-include ../../../../etc/Makefile.hopconfig
-include ../../../../etc/Makefile.version
-include $(BIGLOOLIBDIR)/Makefile.config
-include $(BIGLOOLIBDIR)/Makefile.misc

RPATH += $(HOPLIBDIR)/$(HOPFILDIR)

DIR = node_modules/$(PACKAGE)/lib
LIBSDIR = hop/$(HOPRELEASE)/$(DIR)/so/$(HOPRELEASE)/$(HOPBUILDTAG)/$(MACH)
HOPAPPLIBS = js2scheme hop hopscript nodejs
APPRELEASE = $(HOPRELEASE)
LDINSTALLNAMEDIR = $(DESTDIR)$(HOPLIBDIR)/$(HOPFILDIR) 

shared-lib:
	$(MAKE) bigloo-shared-lib \
           LIBSUFFIXTHREAD=_mt \
           LDINSTALLNAMEDIR=$(LDINSTALLNAMEDIR) \
           BIGLOOEXTRALIBS="$(HOPBIGLOOEXTRALIBS) $(HOPBIGLOOEXTRAAPPLIBS)" \
           BIGLOOAPPLIBS="$(HOPAPPLIBS) $(BIGLOOEXTRAAPPLIBS)"

