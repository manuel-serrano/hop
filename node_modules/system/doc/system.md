${ var doc = require( "@hop/hopdoc" ) }
${ var path = require( "path" ) }
${ var ROOT = path.dirname( module.filename ) }

System
======

This module implements an equivalent to the Unix `system` command. It is
a simplified alternative to the `process` module for spawning and
getting the result of an external command.

Use `require( hop.system )`, or `import * from "hop:system"`, or
`import { system, systemSync } from "hop:system"` to use it.


Functions
---------

### system.system( command ) ###
[:@glyphicon glyphicon-tag function]

Spawns a process executing `command`. Command might either be a string
or an array of strings. The result is a promise that resolves if the
execution succeeds, i.e., if its return code is `0`, and rejects 
otherwise. On resolution, the output the process has generated is the
value of the resolution. On rejection, the value is an object of two
fields:

  * `status`: the evaluation result.
  * `data`: the output (stdout and stderr) of the execution
  
Strings are converted into array of strings using the following function:

```hopscript
function stringToCmd( cmd ) {
   return cmd
      .match( /([^ "']+)|"([^"]*)"|'([^']*)'|(?:[ \t]+)/g )
      .filter( s => !s.match( /^[ \t]+$/ ) )
      .map( s => s[ 0 ] === "'" || s[ 0 ] === '"'
 	       ? s.substring( 1, s.length - 1 )
	       : s );
}
```
 
That is:

```
"foo" -> [ 'foo' ]
"foo bar" -> [ 'foo', 'bar' ]
"foo bar gee" -> [ 'foo', 'bar', 'gee' ]
'foo "bar gee" hux' -> [ 'foo', 'bar gee', 'hux' ]
```

### system.systemSync( command ) ###
[:@glyphicon glyphicon-tag function]

The synchronous, i.e., blocking, version of `system.system`. It spawns
a process executing `command`. Command might either be a string or
an array of strings. The result is either:

  * a string: the output (stdout and stderr) of the execution, 
     if command succeeds.
  * an object with two fields: `status`, and `data`: if the command fails.
  

Example
-------

${ doc.include( ROOT + "/../../../examples/system/README.md" ) }

${ <span class="label label-info">system/system.js</span> }

```hopscript
${ doc.include( ROOT + "/../../../examples/system/system.js", 14 ) }
```




