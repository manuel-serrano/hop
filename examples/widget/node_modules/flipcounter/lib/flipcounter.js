/*=====================================================================*/
/*    .../widget/node_modules/flipcounter/lib/flipcounter.js           */
/*    -------------------------------------------------------------    */
/*    Author      :  Manuel Serrano                                    */
/*    Creation    :  Wed Jun  4 08:13:26 2014                          */
/*    Last change :  Wed Jul 29 20:44:17 2015 (serrano)                */
/*    Copyright   :  2014-15 Manuel Serrano                            */
/*    -------------------------------------------------------------    */
/*    Server Side flipcounter                                          */
/*=====================================================================*/



var hop = require( "hop" );
var path = require( "path" );

var dir = path.dirname( hop.srcDir() );

function FLIPCOUNTER( attributes ) {
   var id = attributes.id;
   var klass = attributes.class;

   delete attributes.id;
   delete attributes.class;
   
   return <DIV data-hss-tag="flipcounter"
      id=${id}
      class=${klass}
      ${attributes}>
      ~{
	 window.addEventListener(
	    "load",
	    function() {
	       var el = document.getElementById( ${id} );
	       var fc = new flipCounter( ${id}, ${attributes} );
	       
	       el.flipcounter = fc;
	       fc.__proto__ = el.__proto__;
	       el.__proto__ = fc;
	    } )
      }
   </DIV>;
}

exports.FLIPCOUNTER = FLIPCOUNTER;

exports.script = path.join( dir, "client", "flipcounter.min.js" );
exports.css = path.join( dir, "hss", "flipcounter.hss" );

Object.seal( exports );
Object.freeze( exports );
